#!/usr/bin/python
#
# (c) Copyright 2009 Cloudera, Inc.
#
# Master Targets file for Cloudera Hadoop distribution (CH) system

# Set some version constants which appear throughout this project.

# Pig
base_pig_ver="0.2.0"
pig_ver_string="pig-" + base_pig_ver

RegisterProperty('pig.base.version', base_pig_ver)
RegisterProperty('pig.repo', '%(srcdir)/repos/pig')
RegisterProperty('pig.base.ref', 'apache/tags/release-%s' % base_pig_ver)
RegisterProperty('pig.build.ref', 'cdh-0.18')
RegisterProperty('pig.pristine.tarball',
                 '%%(srcdir)/repos/pristine/%s.tar.gz' % pig_ver_string)


# Hive
base_hive_ver="0.3.0"
hive_ver_string="hive-" + base_hive_ver

RegisterProperty('hive.base.version', base_hive_ver)
RegisterProperty('hive.repo', '%(srcdir)/repos/hive')
RegisterProperty('hive.base.ref', 'apache/tags/release-%s' % base_hive_ver)
RegisterProperty('hive.build.ref', 'cdh-0.18')
RegisterProperty('hive.pristine.tarball',
                 '%(srcdir)/repos/pristine/hive-0.3.0-hadoop-0.18.0-dev.tar.gz')

# Hadoop
hadoop20Package = cloudera.MagicGitPackage(
                       "hadoop-0.20",                                   # package name
                       "%(srcdir)/repos/hadoop-0.20",                   # git repos directory
                       "0.20.0",                                        # Apache base version
                       "apache/tags/release-0.20.0",             # Apache base ref
                       "cdh-0.20.0",                                    # Cloudera build ref
                       "%(srcdir)/repos/pristine/hadoop-0.20.0.tar.gz"  # Pristine tarball
)

hadoop18Package = cloudera.MagicGitPackage(
                       "hadoop-0.18",                                   # package name
                       "%(srcdir)/repos/hadoop-0.18",                   # git repos directory
                       "0.18.3",                             # Apache base version
                       "release-0.18.3-with-jdiff",              # Apache base ref
                       "cdh-0.18.3",                                    # Cloudera build ref
                       "%(srcdir)/repos/pristine/hadoop-0.18.3.tar.gz",  # Pristine tarball
)

# For backward compatibility...
supportedHadoopPackage = EmptyTarget(required_targets=[":hadoop18Package", ":hadoop20Package"])
defaultTarget(supportedHadoopPackage)

# subdirectory targets:
ProjectList(required_targets=[
  "repos/hadoop-0.20-package/:rpm",
  "repos/hadoop-0.18-package/:rpm",
  "repos/hadoop-0.20-package/:deb",
  "repos/hadoop-0.18-package/:deb",
  "repos/hive-package/:rpm",
  "repos/hive-package/:deb",
  "repos/pig-package/:rpm",
  "repos/pig-package/:deb",
  ":supportedHadoopPackage",
  ])
